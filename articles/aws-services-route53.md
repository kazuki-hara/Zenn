---
title: "AWS試験対策: Route53"
emoji: "🙆"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

# 概要

- 高可用でスケーラブルでフルマネージドな権威DNSサービス

- 権威DNSなので、ユーザがDNSレコードを管理できる

- リソースのヘルスチェックが可能

- AWSで唯一100%の可用性

- 外部サービスでドメインを取得した場合は、外部サービスにRoute53のネームサーバを指定する必要がある (NSレコード)

## 主な設定項目と仕様

### Records

- Domain Name

- Record Type
  
  - A：ホスト名とIPv4を対応させる
  
  - AAAA：ホスト名とIPv6を対応させる
  
  - CNAME：ホスト名と別のホスト名を紐付ける。対象ホストはAまたはAAAAレコードが登録されている必要がある。トップドメインは不可
  
  - NS：ホストゾーンのネームサーバ

- Value

- Routing Policy

- TTL

### CNAMEレコードとAliasレコードの違い

- CNAME
  
  - ホスト名を他のホスト名に紐付ける
  
  - 非ルートドメインのみ対応

- Aliasレコード
  
  - ホスト名をAWSのリソースに紐付ける
  
  - ルートドメインと非ルートドメインに対応する
  
  - 無料、ヘルスチェックがネイティブで存在
  
  - AWSのリソースのIPが変わってもそれを自動で追跡してくれる
  
  - AレコードまたはAAAAレコードで設定する
  
  - 設定可能なリソース
    
    - ELB
    
    - CloudFront
    
    - API Gateway
    
    - Elastic Beanstalk
    
    - S3 Website
    
    - VPC Interface Endpoints
    
    - Route53
    
    - EC2は設定不可

### Routing Policy

- Simple
  
  - トラフィック転送先を一つのリソースに指定する
  
  - 複数のリソースが返ってきた場合は、送信先はクライアントが指定する

- Weighted
  
  - 複数のリソースに対して%で重み付けして転送先を指定する
  
  - 異なるリージョンでの重み付けや、異なるバージョンのテストなどに使える
  
  - すべてのリソースの重みを0にしたら同じ割合で分散される

- Failover
  
  - 一つ目のレコードでリソースのヘルスチェックに失敗したら、二つ目のレコードが適用される
  
  - レコードタイプでセカンダリを指定する

- Latency
  
  - レイテンシーはユーザとAWSリージョン間のトラフィックに基づく

- Geolocaltion
  
  - Webサイトのローカライズや配信の制限などに利用される
  
  - レコードで指定した地域にマッチングしない場合は、デフォルトのレコードが適用される

- Geoproximity
  
  - ユーザの地理的位置とリソースに基づくルーティング
  
  - リージョンごとにバイアスを値で指定する。バイアスが大きいほど、ユーザがリージョンから離れていても、そのリージョンにルーティングされやすくなる

- IP-based Policy
  
  - クライアントのIPアドレスに基づくルーティング
  
  - ネットワークコストの削減やパフォーマンスの最適化に利用される

- Multi-Value
  
  - ヘルスチェックを合格した最大8個のリソースがクライアントに返される
  
  - クライアント側の負荷分散に利用される (ELBの代わりにはならない)

### Health Check

- HTTP Health Checkは、パブリックリソースに対してのみ適用可能

- DNSのFailoverを自動化できる

- CloudWatchでも利用可能。CloudWatchのメトリクスを利用することでプライベートリソースに対しても監視可能

### S3とRoute53

- ターゲットレコードのホスト名と同じ名前のS3バケットを作成する

- Aliasレコードでバケットを指定する (AliasレコードなのでレコードタイプはAレコード)